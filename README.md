# Automatic-forum-reading 阅读记录与推荐扩展

一个智能的 Chrome/Edge 浏览器扩展，用于记录在 `linux.do` 论坛的阅读行为，并提供基于用户兴趣的个性化推荐。

## ✨ 功能特性

### 📊 阅读行为追踪
- **智能阅读检测**：自动识别有效阅读时间（仅在页面可见、前台、非空闲时计入）
- **滚动深度分析**：记录用户滚动深度，判断阅读完成度
- **会话管理**：自动管理浏览会话，合并同一次访问的多个事件

### 🔍 内容抓取
- **增量抓取**：每30分钟自动抓取 `linux.do` 最新帖子
- **API 集成**：直接调用 `https://linux.do/latest.json` API，避免 HTML 解析问题
- **智能去重**：自动识别新帖子，避免重复抓取

### 🎯 智能推荐
- **内容相似度**：基于 TF-IDF 算法计算帖子与用户阅读历史的相似度
- **新鲜度权重**：优先推荐最近7天的新帖子
- **标签推荐**：基于用户常读标签进行推荐
- **混合算法**：结合内容相似度和标签偏好的综合推荐

### 💾 数据管理
- **本地存储**：所有数据存储在浏览器本地 IndexedDB，保护隐私
- **数据导出**：支持导出 JSON 格式的阅读数据
- **统计面板**：实时显示阅读统计和推荐效果

## 🚀 安装使用

### 开发模式安装

1. **下载代码**
   ```bash
   git clone https://github.com/jorzaiy/Automatic-forum-reading.git
   cd Automatic-forum-reading
   ```

2. **启用开发者模式**
   - 打开 Chrome/Edge 浏览器
   - 访问 `chrome://extensions/` 或 `edge://extensions/`
   - 开启右上角的"开发者模式"

3. **加载扩展**
   - 点击"加载已解压的扩展程序"
   - 选择 `extension` 文件夹
   - 扩展安装完成

4. **开始使用**
   - 访问 `https://linux.do` 并登录
   - 浏览帖子页面，扩展会自动记录阅读行为
   - 点击扩展图标查看推荐内容

### 使用说明

#### 扩展弹窗
- **阅读统计**：显示今日阅读数量和完成情况
- **智能推荐**：基于阅读历史的个性化推荐
- **手动抓取**：立即触发新内容抓取

#### 设置页面
- **阅读阈值**：配置有效阅读时长和滚动深度阈值
- **数据管理**：导出/导入阅读数据，清空所有数据
- **抓取控制**：手动触发内容抓取

## 🏗️ 技术架构

### 核心组件

```
extension/
├── manifest.json          # 扩展配置文件
├── background/
│   ├── index.js          # 主服务工作者
│   ├── storage.js        # IndexedDB 存储模块
│   ├── fetcher.js        # 抓取管理器
│   ├── recommender.js    # 推荐算法模块
│   └── fetchers/
│       ├── base-fetcher.js   # 抓取器基类
│       ├── linuxdo-fetcher.js# Linux.do 抓取器
│       └── nodeseek-fetcher.js# NodeSeek 抓取器
├── content/
│   └── reader-tracker.js # 页面行为追踪
└── ui/
    ├── popup.html        # 扩展弹窗
    ├── popup.js          # 弹窗逻辑
    ├── options.html      # 设置页面
    ├── options.js        # 设置逻辑
    └── styles.css        # 样式文件
```

### 数据模型

- **forums**: 论坛基础信息
- **threads**: 帖子信息（标题、分类、标签、发布时间）
- **sessions**: 用户浏览会话
- **read_events**: 详细阅读行为数据

### 推荐算法

1. **内容相似度计算**：基于 TF-IDF 算法
2. **新鲜度衰减**：7天内线性衰减
3. **作者亲和度**：基于历史阅读偏好
4. **综合评分**：`0.5×内容相似度 + 0.3×新鲜度 + 0.2×作者亲和度`

## 🔧 开发指南

### 环境要求
- Chrome 88+ 或 Edge 88+
- 支持 Manifest V3 的浏览器

### 开发调试
1. 在 `chrome://extensions/` 中点击扩展的"检查视图"
2. 查看 Background Service Worker 的控制台日志
3. 使用 Chrome DevTools 调试 Content Script

### 数据导出
- 在设置页面点击"导出 JSON 数据"
- 数据包含所有阅读记录、帖子信息和会话数据
- 可用于数据分析或备份

## 📈 项目状态

### 已完成功能 ✅
- [x] **扩展基础架构**：完整的 Manifest V3 扩展框架
- [x] **阅读行为追踪**：智能检测用户阅读时间、滚动深度、页面可见性
- [x] **数据存储系统**：基于 IndexedDB 的本地数据存储
- [x] **内容抓取功能**：自动抓取 linux.do 最新帖子，支持增量更新
- [x] **智能推荐算法**：基于 TF-IDF 的内容相似度计算
- [x] **用户界面**：完整的弹窗界面和设置页面
- [x] **数据管理**：支持数据导出、导入、清空功能
- [x] **通知系统**：桌面通知推送新内容
- [x] **错误处理**：完善的错误处理和重试机制
- [x] **调试工具**：内置调试功能和状态检查

### 核心特性 🎯
- **隐私保护**：所有数据本地存储，不上传任何用户数据
- **智能推荐**：基于阅读历史的个性化内容推荐
- **实时统计**：阅读时长、帖子数量等统计信息
- **多论坛支持**：支持 linux.do 和 NodeSeek 论坛
- **用户友好**：简洁的界面和直观的操作

### 计划功能 🚧
- [ ] **阅读分析报表**：详细的阅读行为分析
- [ ] **更多论坛支持**：扩展支持更多技术论坛
- [ ] **高级推荐算法**：机器学习算法优化推荐效果
- [ ] **用户偏好设置**：更精细的个性化配置
- [ ] **数据同步**：跨设备数据同步功能

## 🔒 隐私保护

- **本地存储**：所有数据仅存储在用户浏览器本地
- **无数据上传**：不会向任何服务器发送用户数据
- **透明开源**：代码完全开源，可审查所有功能
- **最小权限**：仅请求必要的浏览器权限

## 🐛 问题反馈

如果遇到问题或有功能建议，请：

1. **使用调试工具**：打开项目根目录的 `debug.html` 文件进行环境检查
2. 检查浏览器控制台是否有错误信息
3. 确认已登录 `linux.do` 网站
4. 尝试重新加载扩展
5. 查看设置页面的统计信息是否正常

### 调试工具使用
- 打开 `debug.html` 文件
- 点击"测试阅读记录"和"检查扩展状态"按钮
- 查看环境检查和数据统计结果
- 按照页面提示进行问题排查

## 📄 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

## 📜 开发日志

### `v1.0.0` - 正式发布版本
- **功能完善**：完整的阅读行为追踪和智能推荐系统
- **多论坛支持**：支持 linux.do 和 NodeSeek 论坛
- **用户界面**：完整的弹窗界面和设置页面
- **数据管理**：支持数据导出、导入、清空功能
- **隐私保护**：所有数据本地存储，保护用户隐私

### `v0.3.0` - 稳定性修复与代码重构
- **修复**：解决了 `linux.do` 帖子 ID 提取不正确的问题
- **修复**：通过实现重试机制，降低了 Service Worker 休眠导致的错误
- **重构**：优化了后台抓取逻辑，创建了统一的 `FetcherManager`

## 🤝 贡献指南

欢迎贡献代码！请遵循以下步骤：

1. Fork 本仓库
2. 创建功能分支：`git checkout -b feature/新功能`
3. 提交更改：`git commit -m '添加新功能'`
4. 推送分支：`git push origin feature/新功能`
5. 提交 Pull Request

## 📄 许可证

本项目采用 MIT 许可证，详见 [LICENSE](LICENSE) 文件。

## 🔗 相关链接

- [GitHub 仓库](https://github.com/jorzaiy/Automatic-forum-reading)
- [安装指南](INSTALL.md)
- [问题反馈](https://github.com/jorzaiy/Automatic-forum-reading/issues)

---

**注意**：本扩展仅用于学习和研究目的，请遵守相关网站的使用条款。
